<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html 	xmlns="http://www.w3.org/1999/xhtml"
		xmlns:h="http://java.sun.com/jsf/html"  
   		xmlns:f="http://java.sun.com/jsf/core" 
    	xmlns:p="http://primefaces.org/ui"
    	xmlns:ui="http://java.sun.com/jsf/facelets">
<h:head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>


</h:head>
   	
<h:body>
<ui:composition template="templates/geral.xhtml">
<ui:define name="titulo">RECORD NEWS - TI</ui:define>
<ui:define name="conteudo">
<f:facet name="header">Controle de Contratos</f:facet>

<p:panel>
	<h:form id="formtb">	
	    <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5">

	    </h:panelGrid>
		<br></br>   
			<p:commandButton onclick="PF('dgCad').show()" action="#{contratoMB.novo}" value="Novo Contrato" title="Novo"  update=":formCad"/>
			<p></p>
		<br></br>   			
	    <p:dataTable id="tb" var="c" value="#{contratoMB.contratos}"   
	    	selectionMode="single" selection="#{contratoMB.contrato}" rowKey="#{s}" emptyMessage="">

        	<p:ajax event="rowSelect" listener="#{contratoMB.onRowSelect}" update=":formMsg" oncomplete="PF('dgEdit').show();"/>

	       <p:column headerText="Nº" width="6%">
	            <h:outputText value="#{c.id}" />
	       </p:column>	 
	       <p:column headerText="Tipo" width="20%">
	            <h:outputText value="#{c.tipocontrato.descricao}" />
	       </p:column>	 	       	
	       <p:column headerText="Origem" width="6%">
	            <h:outputText value="#{c.origem eq 'C' ?  'Compra' : 'Venda'}" />
	       </p:column>	
	        <p:column headerText="Início Vigênc." style="width:12%;">
              <h:outputText value="#{c.inicio}">
				 <f:convertDateTime pattern="dd/MM/yyyy" locale="pt_BR"/>
			  </h:outputText>
            </p:column>		       
	        <p:column headerText="Fim Vigênc." style="width:12%;">
              <h:outputText value="#{c.fim}">
				 <f:convertDateTime pattern="dd/MM/yyyy" locale="pt_BR"/>
			  </h:outputText>
            </p:column>		        	
	       <p:column headerText="Cliente / Fornecedor" width="25%">
	            <h:outputText value="#{c.mclifor.nomfan}" />
	       </p:column>	   
	       <p:column headerText="Objeto" width="30%">
	            <h:outputText value="#{c.objeto}" />
	       </p:column>		           		
	    </p:dataTable>
	</h:form>
</p:panel>	

<p:dialog id="dgCad" widgetVar="dgCad" appendTo="@(body)" modal="true" header="Cadastro" resizable="false" >
	<h:form id="formCad" style="width:120 %;">
		<p:panel>
			<p:wizard flowListener="#{contratoMB.onFlowProcess}" backLabel="Anterior" nextLabel="Próximo"  >
		        <p:tab id="gerais" title="Dados Gerais" >
            		<p:panel header="Dados Gerais" >
		            	<p:messages autoUpdate="true"/>
						<p:panelGrid columns="2" >
							<p:outputLabel value="Contrato nro.:"/>
							<p:outputLabel value="#{contratoMB.contrato.id}"/>	
							<p:outputLabel value="Origem:"/>
					        <p:selectOneMenu value="#{contratoMB.contrato.origem}">
					            <f:selectItem itemLabel="Compra" itemValue="C" />
					            <f:selectItem itemLabel="Venda" itemValue="V" />
					        </p:selectOneMenu>
					        
							<p:outputLabel value="Objeto:"/>
							<p:inputText id="obj" value="#{contratoMB.contrato.objeto}" placeholder="Objetivo do contrato" size="60" disabled="#{contratoMB.controlaCadastro eq 0}"
								required="true" requiredMessage="Informe o objetivo do contrato"/>
							<p:outputLabel value="Tipo do Contrato:"/>
					        <p:selectOneMenu id="tp" value="#{contratoMB.tipoContrato}"  disabled="#{contratoMB.controlaCadastro eq 0}" style="width:130px;"
					        		styleClass="oneMenu" converter="tipoContratoConverter">
					            <f:selectItems value="#{contratoMB.tipoContratos}" var="t" itemLabel="#{t.descricao}" itemValue="#{t}" />
					        </p:selectOneMenu>	
							<p:outputLabel value="Cliente / Fornecedor:"/>		        
					        <p:autoComplete id="clifor" value="#{contratoMB.contrato.mclifor}" completeMethod="#{contratoMB.completeCliFor}"
			                        var="cl" itemLabel="#{cl.nomfan}" itemValue="#{cl}" converter="mcliforConverter" forceSelection="true" />
							<h:outputLabel for="dtiv" value="Data Início:"/>
							<p:calendar id="dtiv" value="#{contratoMB.contrato.inicio}" locale="pt_BR" pattern="dd/MM/yyyy" size="11" 
								disabled="#{contratoMB.controlaCadastro==0}" required="true" requiredMessage="Informe data de vigência inicial do contrato"/>												
							<h:outputLabel for="dtif" value="Data Término:"/>		        
							<p:calendar id="dtif" value="#{contratoMB.contrato.fim}" locale="pt_BR" pattern="dd/MM/yyyy" size="11"
								 disabled="#{contratoMB.controlaCadastro==0}" required="true" requiredMessage="Informe data de vigência inicial do contrato"/>								
					        <p:outputLabel value="Contrato Ativo:"/>
					        <p:selectBooleanCheckbox value="#{contratoMB.contrato.ativo}" />								
						</p:panelGrid>
		            </p:panel>
		        </p:tab>	
				<p:tab id="anexos" title="Aditivos" >	
            		<p:panel header="Aditivos" >
		            	<p:messages autoUpdate="true"/>						        
		            </p:panel>
		        </p:tab>	
				<p:tab id="skd" title="Agendamentos" >	
            		<p:panel header="Agendamentos" >
		            	<p:messages autoUpdate="true"/>
		            	<p:panelGrid columns="2">
							<p:outputLabel value="Dias para aviso:"/>	
							<p:inputText />	  
							<p:outputLabel value="Repetir envio:"/>	
					        <p:selectOneMenu value="#{contratoMB.contrato.origem}">
					        	<f:selectItem itemLabel="Não repetir" itemValue="0" />
					            <f:selectItem itemLabel="Um dia" itemValue="1" />
					            <f:selectItem itemLabel="Dois dias" itemValue="2" />
					            <f:selectItem itemLabel="Três dias" itemValue="3" />
					            <f:selectItem itemLabel="Quatro dias" itemValue="4" />	
					            <f:selectItem itemLabel="Cinco dias" itemValue="5" />
					            <f:selectItem itemLabel="Seis dias" itemValue="6" />
					            <f:selectItem itemLabel="Sete dias" itemValue="7" />						            
					            <f:selectItem itemLabel="Dez dias" itemValue="10" />
					            <f:selectItem itemLabel="Quinze dias" itemValue="15" />
					            <f:selectItem itemLabel="Vinte dias" itemValue="20" />					            				            
					        </p:selectOneMenu> 
							<p:outputLabel value="Assunto do e-mail"/>	
							<p:inputText />	
							<p:outputLabel value="Mensagem :"/>	
							<p:inputTextarea maxlength="300" rows="2"/>													        	
				        </p:panelGrid>	
						<p:inputText size="30" placeholder="Digite aqui o e-mail"/>
						<p:commandButton value="Add"/>	
    <p:dataList value="#{dataListView.cars3}" var="car" type="unordered" itemType="none" paginator="true" rows="10" styleClass="paginated">
        <f:facet name="header">
            Paginator
        </f:facet>
        <p:commandLink update=":form:carDetail" oncomplete="PF('carDialog').show()" title="View Detail" styleClass="ui-icon ui-icon-search" style="float:left;margin-right:10px">
            <f:setPropertyActionListener value="#{car}" target="#{dataListView.selectedCar}" />
            <h:outputText value="#{car.brand}, #{car.year}" />
        </p:commandLink>
        <h:outputText value="#{car.brand}, #{car.year}" style="display:inline-block"/>
    </p:dataList>						
										        							          						        
		            </p:panel>
		        </p:tab>		        	        					
			</p:wizard>
			<f:facet name="footer">
				<p:panelGrid columns="2" >
					<p:commandButton value="Salvar" action="#{contratoMB.grava}" update=":formCad,:formMsg,:formtb" oncomplete="PF('dgCad').hide()"/>
					<p:commandButton value="Cancelar"  oncomplete="PF('dgCad').hide()"/>
				</p:panelGrid>
			</f:facet>
			
		</p:panel>
	</h:form>
</p:dialog>


<p:dialog modal="false" widgetVar="statusDialog" header="Aguarde..." draggable="false" closable="false" resizable="false"  appendTo="@(body)">
    <p:graphicImage value="img/ajaxloadingbar.gif" />
</p:dialog>
	
<h:form id="formMsg">                      
    <p:growl id="msg" showDetail="true" life="8000"/> 
</h:form>
</ui:define>
</ui:composition>	

<script type="text/javascript">
function start() {
    PF('statusDialog').show();
}
 
function stop() {
    PF('statusDialog').hide();
}
</script>
</h:body>	

</html>